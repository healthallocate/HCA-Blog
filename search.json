[
  {
    "objectID": "posts/time_varying_epts.html",
    "href": "posts/time_varying_epts.html",
    "title": "Time Varying EPTS",
    "section": "",
    "text": "In the SRTR Standard Analysis Files, the CAND_KIPA file includes information on candidates listed for kidney and/or pancreas transplants. From this file, it is possible to calculate a candidate EPTS score at listing, but it does not directly account for the change in dialysis time and age during a patient’s time on the waitlist that can lead to higher EPTS scores over time. To perform analyses on EPTS scores that change over time, it is possible to request an enhanced SAF from the SRTR that includes time-varying EPTS. Alternatively, you can consctruct a discrete time dataset that can be used to calculate EPTS at different periods during a candidate’s time on the waitlist. In this post we will address how we constructed such a dataset for our manuscript Association of Race and Ethnicity with Priority for Deceased Donor Kidney Transplant.\nLet’s take a look at our data:\n\n\n\n\n\nPX_ID\nmin_list_date\nprevious_TX\ndialysis\nwaitlist_end_date\ndiabetes\nage_months\nCAN_DIAL_DT\ndialysis_time_at_list\nwait_time\n\n\n\n\n1\n2015-09-03\n0\n0\n2016-02-09\n0\n713\n2015-11-15\n0\n159 days\n\n\n2\n2012-02-03\n0\n1\n2012-04-16\n0\n439\n2011-09-20\n136\n73 days\n\n\n3\n2014-04-30\n1\n0\n2014-12-20\n0\n339\nNA\n0\n234 days\n\n\n4\n2012-07-01\n0\n1\n2015-01-01\n0\n654\n2011-07-01\n366\n914 days\n\n\n5\n2012-07-01\n0\n0\n2015-01-01\n0\n654\n2013-01-01\n0\n914 days\n\n\n6\n2012-07-01\n0\n0\n2015-01-01\n0\n654\nNA\n0\n914 days\n\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nThese data are fabricated and do not represent real patients listed for kidney transplant\n\n\n\n\nPX_ID is a unique patient identifier\nmin_list_date is the earliest date a patient is listed for a transplant. This takes into account patients who are listed at multiple centers concurrently. We will explain how to address such patients in another post.\nprevious_TX is an indicator for whether the patient has received a previous transplant\ndialysis is an indicator for whether the patient was on dialysis when they were listed\nwaitlist_end_date is the date that the patient received a transplant or was otherwise removed from the waiting list\ndiabetes is an indicator for whether the candidate has diabetes\nage_months is the candidate’s age in months at listing\nCAN_DIAL_DT is the date the candidate started dialysis (if at all)\ndialysis_time_at_list is how long the patient was on dialysis before being placed on the waitlist\nwait_time is the time between the candidate’s listing and their waitlist end date\n\n\nWith these variables we would be able to calculate a patient’s EPTS score at listing, but neither the age nor dialysis time variable captures changes over time. To address this, we can create a discrete time data set with 1 month intervals such that the age and dialysis time increase every month that the candidate is on the waitlist.\n\nFirst, we will flag patient’s who were pre-emptively listed and then started dialysis during their time on the waitlist:\n\ndf_epts_varying$dialysis_during_waitlist &lt;- ifelse(df_epts_varying$CAN_DIAL_DT &gt; df_epts_varying$min_list_date, 1, 0)\ndf_epts_varying$dialysis_during_waitlist[is.na(df_epts_varying$dialysis_during_waitlist)] &lt;- 0\n\n\nWe will then calculate the total months that each patient was on the waitlist:\n\ndf_epts_varying = df_epts_varying  %&gt;% mutate(time_period = as.integer(floor((wait_time)*12/365)))\n\n\nTo properly encode the dialysis time for patients who begin dialysis after listing, we use a time_until_dialysis variable, which we will later compare to the patient’s time on the waitlist to trigger the dialysis_time variable to start increasing\n\ndf_epts_varying = df_epts_varying %&gt;% mutate(time_until_dialysis = ifelse(dialysis_during_waitlist == 1, as.integer(floor((CAN_DIAL_DT - min_list_date)*12/365)), 0))\n\n\nUsing the time period variable, we construct a dataset which has an observation for each month the patient is on the waitlist.\n\nexpanded_data &lt;- df_epts_varying %&gt;%\n  tidyr::uncount(weights = time_period + 1) %&gt;%\n  group_by(PX_ID) %&gt;%\n  mutate(time = ifelse(row_number() &lt;= time_period + 1, row_number() - 1, NA),\n    time = ifelse(is.na(time), max(time, na.rm = TRUE), time),\n    age = age_months/12\n  ) %&gt;%\n  mutate(age = age + row_number()/12)\n\nexpanded_data = expanded_data %&gt;% \n  mutate(dialysis_after_waitlist = case_when(\n    dialysis_during_waitlist == 1 & (time - time_until_dialysis) &lt; 0 ~ 0, \n    dialysis_during_waitlist == 1 & (time - time_until_dialysis) &gt;= 0 ~ (time - time_until_dialysis), \n    dialysis_during_waitlist == 0 & dialysis == 1 ~ (time - time_until_dialysis),\n    TRUE ~ 0))\n\nexpanded_data = expanded_data %&gt;% mutate(dialysis_time = dialysis_time_at_list + dialysis_after_waitlist/12)\n\n\nAs we can see below, this process allows us to determine dialysis time and age at each month of a patient’s time on the waitlist in order to accurately calculate EPTS at each time step\n\n\n\n\n\n\nPX_ID\ntime\ndialysis_time_at_list\ndialysis_after_waitlist\ndialysis_time\nage\n\n\n\n\n1\n0\n0\n0\n0.0000000\n59.50000\n\n\n1\n1\n0\n0\n0.0000000\n59.58333\n\n\n1\n2\n0\n0\n0.0000000\n59.66667\n\n\n1\n3\n0\n1\n0.0833333\n59.75000\n\n\n1\n4\n0\n2\n0.1666667\n59.83333\n\n\n1\n5\n0\n3\n0.2500000\n59.91667\n\n\n2\n0\n136\n0\n136.0000000\n36.66667\n\n\n2\n1\n136\n1\n136.0833333\n36.75000\n\n\n2\n2\n136\n2\n136.1666667\n36.83333\n\n\n3\n0\n0\n0\n0.0000000\n28.33333\n\n\n3\n1\n0\n0\n0.0000000\n28.41667\n\n\n3\n2\n0\n0\n0.0000000\n28.50000\n\n\n3\n3\n0\n0\n0.0000000\n28.58333\n\n\n3\n4\n0\n0\n0.0000000\n28.66667\n\n\n3\n5\n0\n0\n0.0000000\n28.75000\n\n\n3\n6\n0\n0\n0.0000000\n28.83333\n\n\n3\n7\n0\n0\n0.0000000\n28.91667\n\n\n4\n0\n366\n0\n366.0000000\n54.58333\n\n\n4\n1\n366\n1\n366.0833333\n54.66667\n\n\n4\n2\n366\n2\n366.1666667\n54.75000\n\n\n4\n3\n366\n3\n366.2500000\n54.83333\n\n\n4\n4\n366\n4\n366.3333333\n54.91667\n\n\n4\n5\n366\n5\n366.4166667\n55.00000\n\n\n4\n6\n366\n6\n366.5000000\n55.08333\n\n\n4\n7\n366\n7\n366.5833333\n55.16667\n\n\n4\n8\n366\n8\n366.6666667\n55.25000\n\n\n4\n9\n366\n9\n366.7500000\n55.33333\n\n\n4\n10\n366\n10\n366.8333333\n55.41667\n\n\n4\n11\n366\n11\n366.9166667\n55.50000\n\n\n4\n12\n366\n12\n367.0000000\n55.58333\n\n\n4\n13\n366\n13\n367.0833333\n55.66667\n\n\n4\n14\n366\n14\n367.1666667\n55.75000\n\n\n4\n15\n366\n15\n367.2500000\n55.83333\n\n\n4\n16\n366\n16\n367.3333333\n55.91667\n\n\n4\n17\n366\n17\n367.4166667\n56.00000\n\n\n4\n18\n366\n18\n367.5000000\n56.08333\n\n\n4\n19\n366\n19\n367.5833333\n56.16667\n\n\n4\n20\n366\n20\n367.6666667\n56.25000\n\n\n4\n21\n366\n21\n367.7500000\n56.33333\n\n\n4\n22\n366\n22\n367.8333333\n56.41667\n\n\n4\n23\n366\n23\n367.9166667\n56.50000\n\n\n4\n24\n366\n24\n368.0000000\n56.58333\n\n\n4\n25\n366\n25\n368.0833333\n56.66667\n\n\n4\n26\n366\n26\n368.1666667\n56.75000\n\n\n4\n27\n366\n27\n368.2500000\n56.83333\n\n\n4\n28\n366\n28\n368.3333333\n56.91667\n\n\n4\n29\n366\n29\n368.4166667\n57.00000\n\n\n4\n30\n366\n30\n368.5000000\n57.08333\n\n\n5\n0\n0\n0\n0.0000000\n54.58333\n\n\n5\n1\n0\n0\n0.0000000\n54.66667\n\n\n5\n2\n0\n0\n0.0000000\n54.75000\n\n\n5\n3\n0\n0\n0.0000000\n54.83333\n\n\n5\n4\n0\n0\n0.0000000\n54.91667\n\n\n5\n5\n0\n0\n0.0000000\n55.00000\n\n\n5\n6\n0\n0\n0.0000000\n55.08333\n\n\n5\n7\n0\n1\n0.0833333\n55.16667\n\n\n5\n8\n0\n2\n0.1666667\n55.25000\n\n\n5\n9\n0\n3\n0.2500000\n55.33333\n\n\n5\n10\n0\n4\n0.3333333\n55.41667\n\n\n5\n11\n0\n5\n0.4166667\n55.50000\n\n\n5\n12\n0\n6\n0.5000000\n55.58333\n\n\n5\n13\n0\n7\n0.5833333\n55.66667\n\n\n5\n14\n0\n8\n0.6666667\n55.75000\n\n\n5\n15\n0\n9\n0.7500000\n55.83333\n\n\n5\n16\n0\n10\n0.8333333\n55.91667\n\n\n5\n17\n0\n11\n0.9166667\n56.00000\n\n\n5\n18\n0\n12\n1.0000000\n56.08333\n\n\n5\n19\n0\n13\n1.0833333\n56.16667\n\n\n5\n20\n0\n14\n1.1666667\n56.25000\n\n\n5\n21\n0\n15\n1.2500000\n56.33333\n\n\n5\n22\n0\n16\n1.3333333\n56.41667\n\n\n5\n23\n0\n17\n1.4166667\n56.50000\n\n\n5\n24\n0\n18\n1.5000000\n56.58333\n\n\n5\n25\n0\n19\n1.5833333\n56.66667\n\n\n5\n26\n0\n20\n1.6666667\n56.75000\n\n\n5\n27\n0\n21\n1.7500000\n56.83333\n\n\n5\n28\n0\n22\n1.8333333\n56.91667\n\n\n5\n29\n0\n23\n1.9166667\n57.00000\n\n\n5\n30\n0\n24\n2.0000000\n57.08333\n\n\n6\n0\n0\n0\n0.0000000\n54.58333\n\n\n6\n1\n0\n0\n0.0000000\n54.66667\n\n\n6\n2\n0\n0\n0.0000000\n54.75000\n\n\n6\n3\n0\n0\n0.0000000\n54.83333\n\n\n6\n4\n0\n0\n0.0000000\n54.91667\n\n\n6\n5\n0\n0\n0.0000000\n55.00000\n\n\n6\n6\n0\n0\n0.0000000\n55.08333\n\n\n6\n7\n0\n0\n0.0000000\n55.16667\n\n\n6\n8\n0\n0\n0.0000000\n55.25000\n\n\n6\n9\n0\n0\n0.0000000\n55.33333\n\n\n6\n10\n0\n0\n0.0000000\n55.41667\n\n\n6\n11\n0\n0\n0.0000000\n55.50000\n\n\n6\n12\n0\n0\n0.0000000\n55.58333\n\n\n6\n13\n0\n0\n0.0000000\n55.66667\n\n\n6\n14\n0\n0\n0.0000000\n55.75000\n\n\n6\n15\n0\n0\n0.0000000\n55.83333\n\n\n6\n16\n0\n0\n0.0000000\n55.91667\n\n\n6\n17\n0\n0\n0.0000000\n56.00000\n\n\n6\n18\n0\n0\n0.0000000\n56.08333\n\n\n6\n19\n0\n0\n0.0000000\n56.16667\n\n\n6\n20\n0\n0\n0.0000000\n56.25000\n\n\n6\n21\n0\n0\n0.0000000\n56.33333\n\n\n6\n22\n0\n0\n0.0000000\n56.41667\n\n\n6\n23\n0\n0\n0.0000000\n56.50000\n\n\n6\n24\n0\n0\n0.0000000\n56.58333\n\n\n6\n25\n0\n0\n0.0000000\n56.66667\n\n\n6\n26\n0\n0\n0.0000000\n56.75000\n\n\n6\n27\n0\n0\n0.0000000\n56.83333\n\n\n6\n28\n0\n0\n0.0000000\n56.91667\n\n\n6\n29\n0\n0\n0.0000000\n57.00000\n\n\n6\n30\n0\n0\n0.0000000\n57.08333\n\n\n\n\n\n\n\n\nEach patient’s raw EPTS score is calculated using the following formula:\nRaw EPTS = 0.047*max(Age-25,0)- 0.015*Diabetes*max(Age-25,0) \\\\ + 0.398*Prior Organ Transplant - 0.237*Diabetes*Prior Organ Transplant \\\\ + 0.315*log(Dialysis Time + 1) - 0.099*Diabetes*log(Dialysis Time + 1) \\\\+ 0.130*(Dialysis Time = 0) - 0.348*Diabetes*(Dialysis Time = 0) + 1.262*Diabetes\n\nWe then use the EPTS mapping table from 2021 shown here to calculate EPTS of these patients at each month on the waitlist.\n\n\n\n\n\n\n\n\n\n\n\n\nIf the raw EPTS is between\n\n\nThen\n\n\n\n\n&gt;\n\n\n&lt;=\n\n\nEPTS is\n\n\n\n\n\n\n\n\n\n\n0.0000000\n1.842390e-02\n0\n\n\n0.0184239\n2.358706e-01\n1\n\n\n0.2358706\n4.188522e-01\n2\n\n\n0.4188522\n5.280000e-01\n3\n\n\n0.5280000\n6.285256e-01\n4\n\n\n0.6285256\n7.135270e-01\n5\n\n\n0.7135270\n7.922030e-01\n6\n\n\n0.7922030\n8.671443e-01\n7\n\n\n0.8671443\n9.304798e-01\n8\n\n\n0.9304798\n9.939185e-01\n9\n\n\n0.9939185\n1.055990e+00\n10\n\n\n1.0559898\n1.114348e+00\n11\n\n\n1.1143479\n1.170456e+00\n12\n\n\n1.1704557\n1.220301e+00\n13\n\n\n1.2203005\n1.272125e+00\n14\n\n\n1.2721250\n1.319138e+00\n15\n\n\n1.3191377\n1.364385e+00\n16\n\n\n1.3643854\n1.411682e+00\n17\n\n\n1.4116824\n1.454332e+00\n18\n\n\n1.4543320\n1.494737e+00\n19\n\n\n1.4947372\n1.535142e+00\n20\n\n\n1.5351424\n1.573005e+00\n21\n\n\n1.5730051\n1.608103e+00\n22\n\n\n1.6081034\n1.642976e+00\n23\n\n\n1.6429760\n1.673541e+00\n24\n\n\n1.6735411\n1.702554e+00\n25\n\n\n1.7025537\n1.731507e+00\n26\n\n\n1.7315065\n1.758694e+00\n27\n\n\n1.7586938\n1.784780e+00\n28\n\n\n1.7847796\n1.811802e+00\n29\n\n\n1.8118022\n1.836835e+00\n30\n\n\n1.8368350\n1.860602e+00\n31\n\n\n1.8606023\n1.883752e+00\n32\n\n\n1.8837516\n1.907272e+00\n33\n\n\n1.9072723\n1.929411e+00\n34\n\n\n1.9294107\n1.951500e+00\n35\n\n\n1.9514996\n1.973708e+00\n36\n\n\n1.9737084\n1.994142e+00\n37\n\n\n1.9941416\n2.014865e+00\n38\n\n\n2.0148654\n2.033233e+00\n39\n\n\n2.0332331\n2.053976e+00\n40\n\n\n2.0539760\n2.073276e+00\n41\n\n\n2.0732762\n2.092022e+00\n42\n\n\n2.0920218\n2.110557e+00\n43\n\n\n2.1105572\n2.127109e+00\n44\n\n\n2.1271095\n2.144695e+00\n45\n\n\n2.1446947\n2.162066e+00\n46\n\n\n2.1620664\n2.178958e+00\n47\n\n\n2.1789580\n2.195336e+00\n48\n\n\n2.1953362\n2.212030e+00\n49\n\n\n2.2120298\n2.228307e+00\n50\n\n\n2.2283066\n2.244865e+00\n51\n\n\n2.2448652\n2.259348e+00\n52\n\n\n2.2593477\n2.274579e+00\n53\n\n\n2.2745791\n2.290074e+00\n54\n\n\n2.2900737\n2.305555e+00\n55\n\n\n2.3055553\n2.321628e+00\n56\n\n\n2.3216283\n2.336763e+00\n57\n\n\n2.3367630\n2.352642e+00\n58\n\n\n2.3526424\n2.368047e+00\n59\n\n\n2.3680465\n2.382880e+00\n60\n\n\n2.3828801\n2.397443e+00\n61\n\n\n2.3974431\n2.411764e+00\n62\n\n\n2.4117645\n2.426611e+00\n63\n\n\n2.4266108\n2.441439e+00\n64\n\n\n2.4414390\n2.456166e+00\n65\n\n\n2.4561660\n2.470464e+00\n66\n\n\n2.4704641\n2.485417e+00\n67\n\n\n2.4854167\n2.500826e+00\n68\n\n\n2.5008259\n2.515759e+00\n69\n\n\n2.5157591\n2.531790e+00\n70\n\n\n2.5317904\n2.548471e+00\n71\n\n\n2.5484715\n2.564502e+00\n72\n\n\n2.5645021\n2.580563e+00\n73\n\n\n2.5805634\n2.596225e+00\n74\n\n\n2.5962254\n2.612206e+00\n75\n\n\n2.6122058\n2.629802e+00\n76\n\n\n2.6298023\n2.646337e+00\n77\n\n\n2.6463374\n2.662708e+00\n78\n\n\n2.6627084\n2.680714e+00\n79\n\n\n2.6807143\n2.699657e+00\n80\n\n\n2.6996572\n2.719246e+00\n81\n\n\n2.7192464\n2.738536e+00\n82\n\n\n2.7385362\n2.757782e+00\n83\n\n\n2.7577815\n2.777288e+00\n84\n\n\n2.7772876\n2.797192e+00\n85\n\n\n2.7971922\n2.818845e+00\n86\n\n\n2.8188454\n2.839567e+00\n87\n\n\n2.8395672\n2.861173e+00\n88\n\n\n2.8611734\n2.884584e+00\n89\n\n\n2.8845836\n2.906797e+00\n90\n\n\n2.9067967\n2.931876e+00\n91\n\n\n2.9318760\n2.955637e+00\n92\n\n\n2.9556373\n2.981927e+00\n93\n\n\n2.9819266\n3.010420e+00\n94\n\n\n3.0104196\n3.042116e+00\n95\n\n\n3.0421156\n3.076537e+00\n96\n\n\n3.0765369\n3.118385e+00\n97\n\n\n3.1183851\n3.171600e+00\n98\n\n\n3.1715997\n3.248494e+00\n99\n\n\n3.2484942\n1.000000e+09\n100\n\n\n\n\n\n\n\n\nThis results in our final dataset which includes each EPTS variable and the resulting EPTS score for each month a patient is on the wailist.\n\n\n\n\n\n\nPX_ID\nAge\nDialysis Time\nPrevious TX\nDiabetes\nPercentile EPTS\n\n\n\n\n1\n59.50000\n0.0000000\n0\n0\n27\n\n\n1\n59.58333\n0.0000000\n0\n0\n27\n\n\n1\n59.66667\n0.0000000\n0\n0\n28\n\n\n1\n59.75000\n0.0833333\n0\n0\n24\n\n\n1\n59.83333\n0.1666667\n0\n0\n25\n\n\n1\n59.91667\n0.2500000\n0\n0\n26\n\n\n2\n36.66667\n136.0000000\n0\n0\n43\n\n\n2\n36.75000\n136.0833333\n0\n0\n43\n\n\n2\n36.83333\n136.1666667\n0\n0\n43\n\n\n3\n28.33333\n0.0000000\n1\n0\n5\n\n\n3\n28.41667\n0.0000000\n1\n0\n5\n\n\n3\n28.50000\n0.0000000\n1\n0\n5\n\n\n3\n28.58333\n0.0000000\n1\n0\n5\n\n\n3\n28.66667\n0.0000000\n1\n0\n5\n\n\n3\n28.75000\n0.0000000\n1\n0\n5\n\n\n3\n28.83333\n0.0000000\n1\n0\n5\n\n\n3\n28.91667\n0.0000000\n1\n0\n5\n\n\n4\n54.58333\n366.0000000\n0\n0\n100\n\n\n4\n54.66667\n366.0833333\n0\n0\n100\n\n\n4\n54.75000\n366.1666667\n0\n0\n100\n\n\n4\n54.83333\n366.2500000\n0\n0\n100\n\n\n4\n54.91667\n366.3333333\n0\n0\n100\n\n\n4\n55.00000\n366.4166667\n0\n0\n100\n\n\n4\n55.08333\n366.5000000\n0\n0\n100\n\n\n4\n55.16667\n366.5833333\n0\n0\n100\n\n\n4\n55.25000\n366.6666667\n0\n0\n100\n\n\n4\n55.33333\n366.7500000\n0\n0\n100\n\n\n4\n55.41667\n366.8333333\n0\n0\n100\n\n\n4\n55.50000\n366.9166667\n0\n0\n100\n\n\n4\n55.58333\n367.0000000\n0\n0\n100\n\n\n4\n55.66667\n367.0833333\n0\n0\n100\n\n\n4\n55.75000\n367.1666667\n0\n0\n100\n\n\n4\n55.83333\n367.2500000\n0\n0\n100\n\n\n4\n55.91667\n367.3333333\n0\n0\n100\n\n\n4\n56.00000\n367.4166667\n0\n0\n100\n\n\n4\n56.08333\n367.5000000\n0\n0\n100\n\n\n4\n56.16667\n367.5833333\n0\n0\n100\n\n\n4\n56.25000\n367.6666667\n0\n0\n100\n\n\n4\n56.33333\n367.7500000\n0\n0\n100\n\n\n4\n56.41667\n367.8333333\n0\n0\n100\n\n\n4\n56.50000\n367.9166667\n0\n0\n100\n\n\n4\n56.58333\n368.0000000\n0\n0\n100\n\n\n4\n56.66667\n368.0833333\n0\n0\n100\n\n\n4\n56.75000\n368.1666667\n0\n0\n100\n\n\n4\n56.83333\n368.2500000\n0\n0\n100\n\n\n4\n56.91667\n368.3333333\n0\n0\n100\n\n\n4\n57.00000\n368.4166667\n0\n0\n100\n\n\n4\n57.08333\n368.5000000\n0\n0\n100\n\n\n5\n54.58333\n0.0000000\n0\n0\n20\n\n\n5\n54.66667\n0.0000000\n0\n0\n20\n\n\n5\n54.75000\n0.0000000\n0\n0\n20\n\n\n5\n54.83333\n0.0000000\n0\n0\n20\n\n\n5\n54.91667\n0.0000000\n0\n0\n21\n\n\n5\n55.00000\n0.0000000\n0\n0\n21\n\n\n5\n55.08333\n0.0000000\n0\n0\n21\n\n\n5\n55.16667\n0.0833333\n0\n0\n18\n\n\n5\n55.25000\n0.1666667\n0\n0\n19\n\n\n5\n55.33333\n0.2500000\n0\n0\n20\n\n\n5\n55.41667\n0.3333333\n0\n0\n20\n\n\n5\n55.50000\n0.4166667\n0\n0\n21\n\n\n5\n55.58333\n0.5000000\n0\n0\n21\n\n\n5\n55.66667\n0.5833333\n0\n0\n22\n\n\n5\n55.75000\n0.6666667\n0\n0\n22\n\n\n5\n55.83333\n0.7500000\n0\n0\n23\n\n\n5\n55.91667\n0.8333333\n0\n0\n24\n\n\n5\n56.00000\n0.9166667\n0\n0\n24\n\n\n5\n56.08333\n1.0000000\n0\n0\n25\n\n\n5\n56.16667\n1.0833333\n0\n0\n25\n\n\n5\n56.25000\n1.1666667\n0\n0\n26\n\n\n5\n56.33333\n1.2500000\n0\n0\n26\n\n\n5\n56.41667\n1.3333333\n0\n0\n27\n\n\n5\n56.50000\n1.4166667\n0\n0\n27\n\n\n5\n56.58333\n1.5000000\n0\n0\n28\n\n\n5\n56.66667\n1.5833333\n0\n0\n29\n\n\n5\n56.75000\n1.6666667\n0\n0\n29\n\n\n5\n56.83333\n1.7500000\n0\n0\n30\n\n\n5\n56.91667\n1.8333333\n0\n0\n30\n\n\n5\n57.00000\n1.9166667\n0\n0\n31\n\n\n5\n57.08333\n2.0000000\n0\n0\n31\n\n\n6\n54.58333\n0.0000000\n0\n0\n20\n\n\n6\n54.66667\n0.0000000\n0\n0\n20\n\n\n6\n54.75000\n0.0000000\n0\n0\n20\n\n\n6\n54.83333\n0.0000000\n0\n0\n20\n\n\n6\n54.91667\n0.0000000\n0\n0\n21\n\n\n6\n55.00000\n0.0000000\n0\n0\n21\n\n\n6\n55.08333\n0.0000000\n0\n0\n21\n\n\n6\n55.16667\n0.0000000\n0\n0\n21\n\n\n6\n55.25000\n0.0000000\n0\n0\n21\n\n\n6\n55.33333\n0.0000000\n0\n0\n21\n\n\n6\n55.41667\n0.0000000\n0\n0\n21\n\n\n6\n55.50000\n0.0000000\n0\n0\n21\n\n\n6\n55.58333\n0.0000000\n0\n0\n21\n\n\n6\n55.66667\n0.0000000\n0\n0\n21\n\n\n6\n55.75000\n0.0000000\n0\n0\n22\n\n\n6\n55.83333\n0.0000000\n0\n0\n22\n\n\n6\n55.91667\n0.0000000\n0\n0\n22\n\n\n6\n56.00000\n0.0000000\n0\n0\n22\n\n\n6\n56.08333\n0.0000000\n0\n0\n22\n\n\n6\n56.16667\n0.0000000\n0\n0\n22\n\n\n6\n56.25000\n0.0000000\n0\n0\n22\n\n\n6\n56.33333\n0.0000000\n0\n0\n22\n\n\n6\n56.41667\n0.0000000\n0\n0\n22\n\n\n6\n56.50000\n0.0000000\n0\n0\n23\n\n\n6\n56.58333\n0.0000000\n0\n0\n23\n\n\n6\n56.66667\n0.0000000\n0\n0\n23\n\n\n6\n56.75000\n0.0000000\n0\n0\n23\n\n\n6\n56.83333\n0.0000000\n0\n0\n23\n\n\n6\n56.91667\n0.0000000\n0\n0\n23\n\n\n6\n57.00000\n0.0000000\n0\n0\n23\n\n\n6\n57.08333\n0.0000000\n0\n0\n23\n\n\n\n\n\n\n\n\nPatients 5 and 6 are an example of two patients who have the same EPTS characteristics but one patient is put on dialysis and the other is not. As we can see here, when patient 5 is put on dialysis it initially lowers their EPTS, but their EPTS soon increases to its previous level and then continues to increase at a much faster pace than patient 6 who is not on dialysis.\n\n\n\n\n\n\n\n\n\n\nsave(df_months, file = \"time_varying_data.Rdata\")"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "HCA Blog",
    "section": "",
    "text": "Welcome to the Healthcare Allocation Lab Blog!\nHere you will find instructional posts on best statistical practices when working with data from the Scientific Registry of Transplant Recipients (SRTR).\nFor source code from our projects, please visit https://github.com/healthallocate\n\n\nPosts\n\n\n\n\n\n\n\n\n\n\n\n\n\nTime Varying EPTS\n\n\n\nData Structures\n\n\nKidney Allocation\n\n\nR\n\n\n\n\n\n\n\nMolly H. White\n\n\nFeb 19, 2024\n\n\n\n\n\n\n\n\n\n\n\n\nPropensity Score Matching\n\n\n\nAnalysis\n\n\nKidney Allocation\n\n\nR\n\n\n\n\n\n\n\nMolly H. White\n\n\nFeb 7, 2024\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/prop_score.html",
    "href": "posts/prop_score.html",
    "title": "Propensity Score Matching",
    "section": "",
    "text": "The purpose of propensity score matching is to identify observations where the covariates that determine assignment to a particular group have similar values across different groups. In our example, we want to identify recipients of single kidney transplants whose Expected Post Transplant Survival (EPTS) characteristics are similar to those of recipients of en bloc kidneys. By identifying such patients, we will be able to better compare post-transplant survival outcomes by accounting for other possible confounding factors. In this case, these covariates are age, dialysis, diabetes, and previous transplant.\nNote that we did not match based on donor characteristics. This is because after donor kidneys are assigned a sequence, they are treated equally to other kidneys in that sequence, so donor characteristics have no additional influence on assignment to each patient. When propensity score matching it is important to match only on those covariates which impact assignment of the treatment to each group.\nHere’s a look at our dataframe:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nenbloc_under8\nREC_AGE_AT_TX\ndialysis_duration\nno_dial\nrec_diabetes\nCAN_PREV_TX\n\n\n\n\n1\n0\n46\n1.7397260\n0\n0\n0\n\n\n34\n0\n64\n0.0000000\n1\n1\n0\n\n\n47\n0\n25\n0.0000000\n1\n0\n1\n\n\n74\n0\n51\n0.0000000\n1\n1\n0\n\n\n81\n0\n66\n2.7315068\n0\n1\n0\n\n\n103\n0\n43\n1.8246575\n0\n0\n0\n\n\n106\n0\n67\n0.4958904\n0\n1\n0\n\n\n108\n0\n51\n0.0000000\n1\n0\n0\n\n\n109\n0\n43\n0.6136986\n0\n0\n0\n\n\n111\n0\n57\n0.9260274\n0\n0\n0\n\n\n\n\n\n\nenbloc_under8 is an indicator for whether the patient received an en bloc kidney from a donor weighing &lt; 8kg\nREC_AGE_AT_TX is the recipient’s age at time of transplant\ndialysis_duration is the time in years that a patient was on dialysis before transplant\nno_dial is an indicator for whether the patient never received dialysis\nrec_diabetes is an indicator for whether the patient had diabetes\nCAN_PREV_TX is an indicator for whether the patient had received a transplant previously.\n\nIn this example, we are going to do 1-to-1 matching, where for each recipient of an ebloc from a donor &lt; 8kg, we are finding 1 recipient of a sequence A SKT with similar characteristics. This is the most common form of propensity score matching but not the only (see Austin 2011)\nTo perform propensity score matching, we use the MatchIt library in R. To ensure that the covariates are sufficiently similar, we include cross terms that allow the standardized mean differences of the covariates to be &lt; 0.1.\n\nmatch_obj = matchit(enbloc_under8 ~ REC_AGE_AT_TX + dialysis_duration + no_dial + rec_diabetes + CAN_PREV_TX + REC_AGE_AT_TX*no_dial + REC_AGE_AT_TX*rec_diabetes, data = seq_a_data_under, method = \"nearest\", distance =\"glm\",\n  ratio = 1,\n  replace = FALSE)\n\nModel specifications:\n\nmethod = “nearest” specifies nearest neighbor matching\ndistance = “glm” specifies the estimation of propensity scores using logistic regression\nratio = 1 specifies 1:1 matching\nreplace = “FALSE” specifies a unique SKT match for each en bloc recipient\n\nTo return a dataset from this matching process, use the match.data() function as follows:\n\nmatch_data_under = match.data(match_obj)\n\nTo visualize the standardized mean differences in the covariates, use the love.plot() function from the cobalt library\n\nlove.plot(match_obj, stats = \"m\", binary = \"std\", threshold = .1, \n          var.order = \"unadjusted\", var.names = v)\n\n\n\n\n\n\n\n\n\nstats = “m” specifies the calculation of mean differences\nbinary = “std” specifies the standardized mean difference\nthreshold = 0.1 includes boundary lines at -0.1 and 0.1 to display the threshold\nvar.order = “unadjusted” displays the variables in order from smallest to largest unadjusted standardized mean difference\nvar.names = v displays the vector v that describes the variable names\n\nAs we can see in the love plot, without matching, recipients of en blocs from donors &lt; 8kg have significantly different values of EPTS characteristics than recipients of sequence A SKTs. By matching on these characteristics, we are able to identify patients who have similar values for these characteristics, leading to standardized mean differences that are all below 0.1.\nReferences:\nAustin PC. An Introduction to Propensity Score Methods for Reducing the Effects of Confounding in Observational Studies. Multivariate Behav Res. 2011;46(3):399-424. doi:10.1080/00273171.2011.568786"
  }
]